{% extends "base.html" %}

{% block subheader%}
A place to create recipes.
{% endblock %}

{% block description%}
Too Lazy?
<br>
<a href="{{ url_for('browse_recipes') }}" class="btn btn-outline-success">Browse Recipes</a>
{% endblock %}

{% block content%}

<div class="container main-container text-center">
    <!--TODO: when submitting the form, send all the info to the databases-->
    <form class="row row-cols-md-2 row-cols-1 p-3" action="{{ url_for('create_recipe') }}" method="POST">
        <div class="col">
            <!--title-->
            <h5>Recipe Details</h5>
            <div class="form-floating m-3">
                {% if recipe.title %}
                    <input class="form-control" id="title" name="title" type="text" placeholder="Title" value="{{ recipe.title }}">
                {% else %}
                    <input class="form-control" id="title" name="title" type="text" placeholder="Title" value="">  
                {% endif %}
                <label for="title">Insert catchy title here</label>
            </div>
            <!--time required-->
            <div class="form-floating m-3">
                {% if recipe.time_required %}
                    <input class="form-control" id="time_required" name="time_required" type="text"
                        placeholder="Time Required" value="{{ recipe.time_required }}">
                {% else %}
                    <input class="form-control" id="time_required" name="time_required" type="text"
                        placeholder="Time Required" value="">
                {% endif %}        
                <label for="time_required">Time Required</label>
            </div>
            <!--food categories-->
            <div class="form-floating m-3">
                <select class="form-select" id="food_category" name="food_category" type="text">
                    <option value="breakfast">Breakfast</option>
                    <option value="lunch">Lunch</option>
                    <option value="dinner">Dinner</option>
                    <option value="dessert">Dessert</option>
                </select>
                <label for="food_category">Food Categories</label>
            </div>
            <!--portions-->
            <div class="form-floating m-3">
                {% if recipe.portions_amount %}
                    <input class="form-control" id="portions_amount" name="portions_amount" type="number" 
                    placeholder="Portions" value="{{ recipe.portions_amount }}">
                {% else %}
                    <input class="form-control" id="portions_amount" name="portions_amount" type="number" 
                    placeholder="Portions">
                {% endif %}
                <label for="portions_amount">Portions</label>
            </div>
        </div>
        <!--add ingredients section-->
        <div class="col">
            <h5>Ingredients</h5>
            <div class="form-floating m-3">
                <input class="form-control" id="ingredients_amount" name="ingredients_amount" type="text" 
                placeholder="Ingredients">
                <label for="ingredients_amount">One ingredient at a time</label>
            </div>
            <button class="btn btn-info" type="submit" value="add_ingredient" 
            formaction="{{ url_for('ingredient_input') }}">
                Add Ingredient
                <i class="fas fa-arrow-down"></i>
            </button>
            <br>
            <!--how to sections card-->
            <div class="card create-recipe-card">
                <ul>
                    {% for ingredient in recipe.ingredients_amount %}
                        <li class="p-1 text-start">
                            {{ ingredient }}
                            <button class="fas fa-trash-alt float-end text-danger btn" method="POST" 
                            formaction="{{ url_for('delete_ingredient', index=loop.index0) }}"></button>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <!--how to section-->
        <div class="col col-md-12">
            <h5>How To</h5>
            <div class="form-floating m-3 how-to-form">
                <textarea class="form-control" name="how_to" id="how_to"></textarea>
                <label for="how_to">First add step one, then step two...</label>
            </div>
            <button class="btn btn-info" type="submit" value="add_step" 
            formaction="{{ url_for('steps_input') }}">
                Add Step
                <i class="fas fa-arrow-down"></i>
            </button>
            <br>
            <div class="card create-recipe-card">
                <ol>
                    {% for section in recipe.how_to %}
                        <li class="p-1 text-start mt-2">
                            {{ section }}
                            <button class="fas fa-trash-alt float-end text-danger btn" method="POST" 
                            formaction="{{ url_for('delete_section', index=loop.index0) }}"></button>
                        </li>
                    {% endfor %}    
                </ol>
            </div>
        </div>
        <!--Submit button-->
        <div class="col-md-12 col-lg-12 mb-3">
            <!--TODO: fix the issue where on page refresh it defaults to the submit button when it should be an update button-->
            {% if recipe.created_by == session.user %}
                <button class="btn btn-success btn-lg" type="submit" value="Update Recipe">Update Recipe</button>
            {% else %}
                <button class="btn btn-success btn-lg" type="submit" value="Create Recipe">Create Recipe</button>
            {% endif %}
        </div>
        <br>
        <!--clear form button-->
        <div class="col-md-12 col-lg-12">
            <button class="btn btn-warning btn-sm" type="reset" value="reset">Clear Form</button>
        </div>
    </form>
</div>

{% endblock %}